FROM python:3.11-alpine

# Install git, docker-cli, and docker-compose
RUN apk add --no-cache git docker-cli docker-compose

# Set working directory
WORKDIR /app

# Copy webhook files
COPY webhook-handler.py /app/webhook-handler.py
COPY deploy.sh /app/deploy.sh

# Make deploy script executable
RUN chmod +x /app/deploy.sh

# Expose port
EXPOSE 8080

# Start the webhook server
CMD ["python3", "webhook-handler.py"]
